var app=app||{};$(function(){"use strict";var e=function(){function e(e){var n=a(),i=t();return 0==n.length?!0:e.name.toLowerCase().indexOf(n)>-1||e.address.toLowerCase().indexOf(n)>-1||i&&e.description.toLowerCase().indexOf(n)>-1}var a=ko.observable(""),t=ko.observable(!1),n=ko.computed(function(){return 0==a().length?app.model():ko.utils.arrayFilter(app.model(),e)}).extend({notify:"always"}),i=ko.computed(function(){var e=n().length;return 0==e?"No places found":"Showing "+e+" great place"+(e>1?"s":"")}),o=function(){ko.applyBindings(n()),app.map=new Map,app.map.initialize("map-canvas"),"ontouchstart"in document.documentElement||$(function(){$("#listview-items").slimScroll({height:"2000px"})})},r=function(e,a){a.preventDefault();var t=$(a.currentTarget),i=t.data("id"),o=n()[i],r=o.name;$("a").toggleClass("active",!1),t.toggleClass("active",!0),$("#description-image").attr("src",o.image),$("#description-text").html("<p>"+o.description+"...</p>"),app.map.search(r,o).done(function(e){var a=new Foursquare;a.get_reviews(r,e).done(function(e,t){a.venue=e,a.tips=t}).fail(function(){}).always(function(t,n){app.map.createMarker(e,r,a)})}).fail(function(){void 0})};return{initialize:o,search_box:a,search_desc_checkbox:t,msg_filter_result:i,filteredPlaces:n,sidebar_click:r}};app.status.done(function(){app.model=ko.observableArray(app.data),app.view=e(),app.view.initialize()}).fail(function(){void 0})});